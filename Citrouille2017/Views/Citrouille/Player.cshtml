@{ 
    string device = ViewBag.Device;
}

<h1>@device</h1>

<video id="video" controls="controls">
    <source src="~/Content/videos/citrouille_@(device).m4v" type="video/mp4">
    Your browser does not support HTML5 video.
</video>

@section scripts {
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            var loop = true;
            var video = document.getElementById("video");

            video.ontimeupdate = function () {
                if (loop && video.currentTime > 46) {
                    //video.volume = 0;
                    video.currentTime = 44.2;
                }
            };

            // Reference the auto-generated proxy for the hub.
            var citrouille = $.connection.citrouilleHub;
            // Create a function that the hub can call back to display messages.
            citrouille.client.Start = function () {
                video.play();
            };

            citrouille.client.Continuer = function () {
                //video.volume = 1;
                loop = false;
            };

            citrouille.client.Reset = function () {
                console.log("reset");
                video.pause();
                video.currentTime = 0;
            };
            
            // Start the connection.
            $.connection.hub.start().done(function () {
                
            });
        });
    </script>
}